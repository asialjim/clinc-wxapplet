<!--clinc.wxml-->

<view class="container">
  <!-- 医疗服务标题 -->
  <view class="clinc-title">
    <text class="title-text">定期就诊提醒</text>
  </view>
  
  <!-- 搜索区域 - 仅专业用户可见 -->
  <view class="search-area" wx:if="{{isProfessionalUser}}">
    <view class="search-item">
      <text class="search-label">姓名：</text>
      <input class="search-input" placeholder="请输入姓名" bindinput="onNameInput" value="{{searchParams.name}}"/>
    </view>
    <view class="search-item">
      <text class="search-label">证件号：</text>
      <input class="search-input" placeholder="请输入证件号" bindinput="onIdNoInput" value="{{searchParams.idNo}}"/>
    </view>
    <view class="search-item">
      <text class="search-label">手机号：</text>
      <input class="search-input" placeholder="请输入手机号" bindinput="onPhoneInput" value="{{searchParams.phone}}"/>
    </view>
    <view class="search-buttons">
      <button class="search-button" bindtap="onSearch">搜索</button>
      <button class="reset-button" bindtap="onReset">重置</button>
    </view>
  </view>
  
  <!-- 就诊提醒记录列表 -->
  <view class="reminder-list">
    <!-- 列表头部 -->
    <view class="list-header">
      <text class="header-cell phone-cell">手机号</text>
      <text class="header-cell date-cell">上次日期</text>
      <text class="header-cell days-cell">有效期(天)</text>
      <text class="header-cell next-cell">下次日期</text>
    </view>
    
    <!-- 列表内容 -->
    <view wx:if="{{!isLoading && reminderList.length > 0}}" class="list-content">
      <view wx:for="{{reminderList}}" wx:key="id" class="list-item {{isUrgent(item.nextDate) ? 'urgent-item' : ''}}">
        <text class="list-cell phone-cell {{isUrgent(item.nextDate) ? 'urgent-text' : ''}}">{{item.phone || '-'}}</text>
        <text class="list-cell date-cell {{isUrgent(item.nextDate) ? 'urgent-text' : ''}}">{{item.lastDate || '-'}}</text>
        <text class="list-cell days-cell {{isUrgent(item.nextDate) ? 'urgent-text' : ''}}">{{item.lastDays || '-'}}</text>
        <text class="list-cell next-cell {{isUrgent(item.nextDate) ? 'urgent' : ''}} {{isUrgent(item.nextDate) ? 'urgent-text' : ''}}">
          {{item.nextDate || '-'}}
        </text>
      </view>
    </view>
    
    <!-- 空状态 -->
    <view wx:if="{{!isLoading && reminderList.length === 0}}" class="empty-state">
      <text class="empty-text">暂无就诊提醒记录</text>
    </view>
    
    <!-- 加载状态 -->
    <view wx:if="{{isLoading}}" class="loading-state">
      <view class="loading-spinner"></view>
      <text class="loading-text">加载中...</text>
    </view>
  </view>
  
  <!-- 分页组件 - 仅专业用户可见 -->
  <view class="pagination" wx:if="{{isProfessionalUser && total > 0 && !isLoading}}">
    <view class="pagination-info">
      <text>共 {{total}} 条记录</text>
    </view>
    <view class="pagination-controls">
      <button class="page-button" disabled="{{page === 1}}" bindtap="prevPage">上一页</button>
      <text class="page-info">{{page}}/{{pages}}</text>
      <button class="page-button" disabled="{{page === pages}}" bindtap="nextPage">下一页</button>
      <picker bindchange="onPageSizeChange" value="{{pageSizeIndex}}" range="{{pageSizeOptions}}">
        <view class="page-size-picker">
          每页 {{size}} 条
        </view>
      </picker>
    </view>
  </view>
</view>